CREATE OR REPLACE VIEW adempiere.JP_CM_Pivot_Payment
 AS
 SELECT 
    p.JP_CM_Payment_ID AS JP_AllPayments_V_ID
    ,p.AD_Client_ID AS AD_Client_ID
    ,p.AD_AllClients_V_ID AS AD_AllClients_V_ID
    ,p.AD_Org_ID AS AD_Org_ID
    ,p.JP_AllOrgs_V_ID AS JP_AllOrgs_V_ID
 	,p.IsActive AS IsActive
    ,p.Created AS Created 
    ,p.Createdby AS Createdby
    ,p.Updated AS Updated
    ,p.Updatedby AS Updatedby   
    
    ,cl.Name AS JP_Client_Name
    ,otrx.Value || '_' || otrx.Name AS JP_OrgTrx_VN
    ,org.Value || '_' || org.Name AS JP_Org_VN
    ,dt.Name AS JP_DocType_Name
    ,oif.JP_BusinessUnit_ID AS JP_BusinessUnit_ID
    ,bu.Value || '_' || bu.name AS JP_BusinessUnit_VN
    ,bu.JP_BusinessArea_ID AS JP_BusinessArea_ID
    ,baa.Value || '_' || baa.name AS JP_BusinessArea_VN
    ,p.JP_AllBPartners_V_ID AS JP_AllBPartners_V_ID
    ,bp.Value || '_' || bp.Name AS JP_BPartner_VN
    ,p.JP_CM_BPartner_ID AS JP_CM_BPartner_ID
    ,cbp.Value || '_' || cbp.Name AS JP_CM_BPartner_VN
    ,cbp.JP_Corporation_ID AS JP_Corporation_ID
    ,crp.value || '_'|| crp.name AS JP_Corporation_VN
    ,crp.JP_CM_CorpType_ID AS JP_CM_CorpType_ID
    ,cct.value || '_'|| cct.name AS JP_CM_CorpType_VN
    ,p.C_Currency_ID AS C_Currency_ID
    ,cy.ISO_Code AS ISO_Code
    ,p.C_BankAccount_ID AS C_BankAccount_ID
    ,bac.Name AS JP_BankAccount_Name
    ,bac.JP_BranchName AS JP_BranchName
    ,bac.BankAccountType AS BankAccountType
    ,bac.C_Bank_ID AS C_Bank_ID
    ,ba.Name AS JP_Bank_Name
    ,p.DocumentNo AS DocumentNo
    ,p.DateTrx AS DateTrx
    ,to_char(p.DateTrx, 'YYYY-MM') AS JP_TrxMonth
    ,p.DateAcct AS DateAcct
    ,to_char(p.DateAcct, 'YYYY-MM') AS JP_AcctMonth
    ,p.IsReceipt AS IsReceipt
    ,p.DocStatus AS DocStatus
    ,p.processed AS processed
    ,p.Description AS Description
    ,p.C_Charge_ID AS C_Charge_ID
    ,ch.Name AS JP_Charge_Name
    ,p.TenderType AS TenderType
    ,p.IsPrePayment AS IsPrePayment 
    ,p.IsReconciled AS IsReconciled
    ,p.IsAllocated AS IsAllocated
    ,p.PayAmt AS PayAmt
    ,p.DiscountAmt AS DiscountAmt
    ,p.WriteOffAmt AS WriteOffAmt
   FROM adempiere.JP_CM_Payment p
     INNER JOIN adempiere.AD_Client cl ON (p.AD_AllClients_V_ID = cl.AD_Client_ID)
     LEFT OUTER JOIN adempiere.AD_Org otrx ON(p.AD_OrgTrx_ID = otrx.AD_Org_ID)
     INNER JOIN adempiere.AD_Org org ON(p.JP_AllOrgs_V_ID = org.AD_Org_ID)
     	INNER JOIN adempiere.AD_OrgInfo oif ON(org.AD_Org_ID = oif.AD_Org_ID)
 	    LEFT OUTER JOIN adempiere.JP_BusinessUnit bu ON(oif.JP_BusinessUnit_ID = bu.JP_BusinessUnit_ID)
 	    LEFT OUTER JOIN adempiere.JP_BusinessArea baa ON(bu.JP_BusinessArea_ID = baa.JP_BusinessArea_ID)
     INNER JOIN adempiere.C_DocType dt ON(p.C_DocType_ID = dt.C_DocType_ID)
     INNER JOIN adempiere.JP_AllBPartners_V bp ON(p.JP_AllBPartners_V_ID = bp.JP_AllBPartners_V_ID)
     INNER JOIN adempiere.JP_CM_BPartner cbp ON(p.JP_CM_BPartner_ID = cbp.JP_CM_BPartner_ID)
     LEFT OUTER JOIN adempiere.JP_Corporation crp ON(cbp.JP_Corporation_ID = crp.JP_Corporation_ID)
     	LEFT OUTER JOIN adempiere.JP_CM_CorpType cct ON(crp.JP_CM_CorpType_ID = cct.JP_CM_CorpType_ID)
     LEFT OUTER JOIN adempiere.C_Currency cy ON(p.C_Currency_ID = cy.C_Currency_ID)
     INNER JOIN adempiere.C_BankAccount bac ON(p.C_BankAccount_ID = bac.C_BankAccount_ID)
     INNER JOIN adempiere.c_bank ba ON(bac.C_Bank_ID = ba.C_Bank_ID)
     LEFT OUTER JOIN adempiere.c_charge ch ON(p.C_Charge_ID = ch.C_Charge_ID)
     ;

ALTER TABLE adempiere.JP_CM_Pivot_Payment
    OWNER TO adempiere;

